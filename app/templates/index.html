{% extends 'base.html' %}

{% block title %} <title>Store</title> {% endblock %}

{% block content %}

<main>
    <h1>–ò—â–∏—Ç–µ <b>–ª—é–±—ã–µ</b> –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏–∑–æ–±—Ä–µ—Ç–µ–Ω–∏—è!</h1>
    <form class="searcher" action="catalog">
        <select id="searchCharacter">
            <option>–ö–∞—Ç–∞–ª–æ–≥</option>
            <option>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</option>
            <option>Sales</option>
            <option>–ö–∞—Ä—Ç–∏–Ω—ã</option>
            <option>–ú–æ–¥–µ–ª—å</option>
        </select>
        <input type="text" method="GET" name="search" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" id="search">
        <button id="search" onclick="searchInfo()"><img src="static/img/gui/arrow.svg"></button>
    </form>
    <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ: <a href="/catalog?search=tardis" id="1">tardis</a></p>
</main>
<section>
    <div class="head">
                <span>
                    <h3>üõí –ß—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å</h3>
                </span>
        <button><a href="catalog">–í–µ—Å—å –∫–∞—Ç–∞–ª–æ–≥</a></button>
    </div>
    <div class="gallery">

        {% for item in items %}

            <div class="card">
                <a href="product?id={{ item.id }}">
                    <img src="/static/img/items/{{ item.images.0 }}" alt="">
                </a>
                <div>
                    <a href="product?id={{ item.id }}">
                        <h4>{{ item.title }}</h4>
                    </a>
                    <p>{{ item.description[:130] }}‚Ä¶</p>
                </div>
            </div>

        {% endfor %}

    </div>
</section>
<section>
    <div class="head">
                <span>
                    <h3>üî• –ë–µ—Å—Ç—Å–µ–ª–ª–µ—Ä—ã</h3>
                </span>
        <button><a href="catalog">–í–µ—Å—å –∫–∞—Ç–∞–ª–æ–≥</a></button>
    </div>
    <div class="gallery">

        {% for item in best_items %}

            <div class="card">
                <a href="product?id={{ item.id }}">
                    <img src="/static/img/items/{{ item.images.0 }}" alt="">
                </a>
                <div>
                    <a href="product?id={{ item.id }}">
                        <h4>{{ item.title }}</h4>
                    </a>
                    <span class="stars">
                        <img src="static/img/gui/star.svg" alt="">
                        <img src="static/img/gui/star.svg" alt="">
                        <img src="static/img/gui/star.svg" alt="">
                        <img src="static/img/gui/star.svg" alt="">
                        <img src="static/img/gui/star.svg" alt="">
                        <p>4.8</p>
                    </span>
                    <span>
                        <div class="price">
                            <p>{{ item.price }} &#8381;</p>
                        </div>
                        <div class="icons">
                            <a href='#'> <img src="static/img/gui/telega_small.svg" alt=""> </a>
                            <a href='#'><img src="static/img/gui/favourite_small.svg" alt=""> </a>
                        </div>
                    </span>
                </div>
            </div>

        {% endfor %}

    </div>
</section>
<div class="notification">
  <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–∫–Ω–∞ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
</div>

<script>
    function searchInfo() {
        window.location.replace("catalog");
        let info = document.getElementById("searchCharacter").value + document.getElementById("search").value;
        let acc = JSON.stringify(info);
        let request;
        if (window.XMLHttpRequest) {
            request = new XMLHttpRequest();
        } else {
            request = new ActiveXObject("Microsoft.XMLHTTP");
        }
        request.open("GET", "/");
        request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        request.onreadystatechange = function () {
            if (request.readyState === 4 && request.status == 200) {
                let catalog = request.response;
                localStorage.setItem("catalog", catalog);
            }
        }
        request.send("search=" + info);
    }
</script>

{% endblock %}
